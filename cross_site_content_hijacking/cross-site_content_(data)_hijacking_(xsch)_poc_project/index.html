<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="Ambulong">
<meta name="description" content="Content hijacking proof-of-concept using Flash, PDF and Silverlight.">
<meta name="keywords" content="csrf,flash csrf,xsch,xss,hijaking,hijack,flash hijacking,poc,swf,security,practict,在线靶场,黑客技术,网络安全,信息安全,漏洞测试,CTF在线,渗透测试,在线练习,演练,实验,pentest,online">
<title>Cross-Site Content (Data) Hijacking (XSCH) PoC Project | VULNSPY</title>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<script src="/js/jquery-1.11.3.min.js"></script>
<script src="/js/jquery-migrate-1.2.1.min.js"></script>
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/ie10-viewport-bug-workaround.css" rel="stylesheet">
<!--[if lt IE 9]><script src="/js/ie8-responsive-file-warning.js"></script><![endif]-->
<script src="/js/ie-emulation-modes-warning.js"></script>
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
<script src="/js/bootstrap.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="/js/ie10-viewport-bug-workaround.js"></script>
<link rel="stylesheet" href="/css/custom.css" />
<script src="/js/functions.js"></script>
<script src="/js/custom.js"></script>
<script>
function GetQueryString(name)
{
     var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
     var r = window.location.search.substr(1).match(reg);
     if(r!=null)return  unescape(r[2]); return null;
}
var lang="en";
var la=(navigator.language) ? navigator.language.toLowerCase() : navigator.userLanguage.toLowerCase();
if(la=='zh-cn' || la=='zh-tw' || la=='zh-hk'){
	lang="cn";
}
</script>
<!--[if lt IE 9]>
	<script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
<![endif]-->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-108901411-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-108901411-2');
</script>
</head>
<body>
<div class="view-header" style="z-index: 999;">
    <ul>
    	<li><a href="/"><h1><img style="width:1.5em;height: auto;margin-top: -0.3em;" src="/images/owl2.png" /></h1></a></li>
        <li><a href="/">VULNSPY</a></li>
        <li><a href="https://blog.vulnspy.com/">BlOG</a></li>
        <div class="pull-right">
            <li><a target="_blank" href="https://www.reddit.com/r/jiuwu/">DISCUSS ON REDDIT</a></li>
            <li><a target="_blank" href="https://www.youtube.com/channel/UCnqjUDkrZ0OFwZvxxiC47gw">YOUTUBE CHANNEL</a></li>
        </div>
    </ul>
</div>
<style>
img{
	max-width: 100%;
}
.lab{
	margin: 0 auto;
	margin-top: 7em;
	max-width: 80em;
	width: 95%;
}
.lab h1{
	padding: 0;
	font-size: 200%;
	text-align: center;
	font-weight: bold;
}

.lab .demo{
	font-size: 115%;
	line-height: 2em;
	border: 1px solid #ccc;
	background: #2C3844;
	margin: 1.8em 0 1em 0;
}
.lab .demo .demo-btn{
	text-align: center;
	font-size: 150%;
	margin: 0.3em 0;
	color: #FFF;
}
.lab .demo .demo-btn a{
	background: transparent;
	padding: 1em;
	font-size: 100%;
	display: block;
	
}
.lab .demo .demo-link{
	background: rgba(0,0,0,.25);
}
.lab .demo a{
	font-size: 50%;
	text-transform: uppercase;
	padding: 0 0.5em;
	color: #FFF;
}
.lab .content{
	font-size: 120%;
	line-height: 2em;
}
.lab .content p{
	margin: 1em 0;
	text-align: justify;
}
</style>
<div class="lab">
	<h1>Cross-Site Content (Data) Hijacking (XSCH) PoC Project</h1>
	<hr/>
	<div class="demo">
		<div class="demo-btn">
			<a target="_blank" href="http://www.vsplate.com/?github=vulnspy/CrossSiteContentHijacking"><span class="glyphicon glyphicon-flag" aria-hidden="true"></span>&nbsp;&nbsp;START TO HACK</a>
		</div>
		<div class="demo-link">
			<a href="http://www.vsplate.com/?github=vulnspy/CrossSiteContentHijacking" target="_blank">http://www.vsplate.com/?github=vulnspy/CrossSiteContentHijacking</a>
			<a class="pull-right" href="https://www.vsplate.com/" target="_blank">Powered by VSPlate</a>
		</div>
	</div>
	<p id="demo-notice" style="padding: 0.5em 0.5em;color:#fff;text-align:center;background:#2c3844;text-transform:uppercase;">VulnSpy provides the online environment for security testing, click '<b>START TO HACK</b>' to start the playing.</p>
	<hr/>
	<div class="content"><p>This project can be used to provide a proof of concept for:</p>
<ul>
<li>Exploiting websites with insecure policy files (crossdomain.xml or clientaccesspolicy.xml) by reading their contents.</li>
<li>Exploiting insecure file upload functionalities which do not check the file contents properly or allow to upload SWF or PDF files without having Content-Disposition header during the download process. In this scenario, the created SWF, XAP, or PDF file should be uploaded with any extension such as .JPG to the target website. Then, the "Object File" value should be set to the URL of the uploaded file to read the target website's contents.</li>
<li>Exploiting CVE-2011-2461 (see the references for more details)</li>
<li>Exploiting websites with insecure HTML5 cross-origin resource sharing (CORS) headers</li>
</ul>
<p>Note: .XAP files can be renamed to any other extension but they cannot be load cross-domain anymore. It seems Silverlight finds the file extension based on the provided URL and ignores it if it is not .XAP. This can still be exploited if a website allows users to use ";" or "/" after the actual file name to add a ".XAP" extension.</p>
<h3 style="margin-top:1.5em;">Usage</h3>
<ul>
<li>Exploiting an insecure policy file:
<ol>
<li>Host the ContentHijacking directory with a web server.</li>
<li>Browse to the index.html page (will be redirected to ContentHijackingLoader.html).</li>
<li>Change the "Object File" field in the HTML page to a suitable object from the "objects" directory ("xfa-manual-ContentHijacking.pdf" cannot be used).</li>
</ol>
</li>
<li>Exploiting an insecure file upload/download:
<ol>
<li>Upload an object file from the "objects" directory to the victim server. These files can also be renamed with another extension when uploaded to another domain (for this purpose, first use Flash and then PDF as Silverlight XAP files will not normally work with another extension from another domain).</li>
<li>The "Object File" field should be set to the location of the uploaded file.</li>
</ol>
</li>
<li>Exploiting CVE-2011-2461
<ol>
<li>The "Object File" field should be set to the vulnerable file.</li>
<li>Select the "Flash CVE-2011-2461 Only" option from the drop-down list of the "Type" field.</li>
</ol>
</li>
<li>Exploiting an insecure CORS policy:
<ol>
<li>The "Object File" field can be set to the local "ContentHijacking.html" file. If you can upload a HTML file in your target domain, you can exploit XSS issues much more easier than using CORS.</li>
</ol>
</li>
</ul>
<h3 style="margin-top:1.5em;">GitHub Source</h3>
<p><a href="https://github.com/vulnspy/CrossSiteContentHijacking" target="_blank">https://github.com/vulnspy/CrossSiteContentHijacking</a></p>
<h3 style="margin-top:1.5em;">Reference</h3>
<p style="text-align:left;">
nccgroup/CrossSiteContentHijacking - <a href="https://github.com/nccgroup/CrossSiteContentHijacking">https://github.com/nccgroup/CrossSiteContentHijacking</a><br>
Even uploading a JPG file can lead to Cross-Site Content Hijacking (client-side attack)! - <a href="https://soroush.secproject.com/blog/2014/05/even-uploading-a-jpg-file-can-lead-to-cross-domain-data-hijacking-client-side-attack/">https://soroush.secproject.com/blog/2014/05/even-uploading-a-jpg-file-can-lead-to-cross-domain-data-hijacking-client-side-attack/</a><br>
Flash it baby! - <a href="https://www.slideshare.net/SoroushDalili/flash-it-baby-finding-vulnerabilities-in-swf-files-v20-65165645">https://www.slideshare.net/SoroushDalili/flash-it-baby-finding-vulnerabilities-in-swf-files-v20-65165645</a><br>
</p></div>
</div>
<script>
if(lang == 'cn'){
	$("#demo-notice").html("VulnSpy 提供了一系列在线测试环境, 点击上方的 '<b>START TO HACK</b>' 开启实验.");
}
</script>
</body>
</html>
